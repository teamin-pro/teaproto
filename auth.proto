syntax = "proto3";

package gtproto;

import "users.proto";

enum AuthMethod {
  UNKNOWN_AUTH_METHOD = 0;
  LOGIN_PASSWORD_AUTH_METHOD = 1; // only for testing
  EMAIL_AUTH_METHOD = 2;
  GOOGLE_AUTH_METHOD = 3;
  APPLE_AUTH_METHOD = 4;
}

message LoginPasswordAuthRequest {
  string login = 1;
  string password = 2;
  bool create_new_account = 3;
}

message LoginPasswordAuthResponse {
  enum Error {
    UNKNOWN_ERROR = 0;

    // login
    INVALID_LOGIN_OR_PASSWORD_ERROR = 1;
    AUTH_METHOD_NOT_SUPPORTED_ERROR = 2;

    // new account
    NEW_ACCOUNT_INVALID_LOGIN_ERROR = 3;
    NEW_ACCOUNT_INVALID_PASSWORD_ERROR = 4;
    NEW_ACCOUNT_LOGIN_ALREADY_USED_ERROR = 5;
  }

  repeated Error errors = 1;

  string token = 2;
  Profile profile = 3;
}

message LogoutRequest {
  repeated string delete_devices = 1;
}

message LogoutResponse {}
